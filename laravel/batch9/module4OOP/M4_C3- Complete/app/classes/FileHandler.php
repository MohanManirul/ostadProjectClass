<?php

/*
    __DIR__ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ рж╢рзБрж░рзБрждрзЗржЗ / ржерж╛ржХржмрзЗ, ржХрж╛рж░ржг ржПржЯрж╛ absolute path рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗред
    echo __DIR__;   // ржмрж░рзНрждржорж╛ржи ржлрж╛ржЗрж▓рзЗрж░ ржлрзЛрж▓рзНржбрж╛рж░ path ржжрзЗржЦрж╛ржмрзЗ
    echo __FILE__;  // ржмрж░рзНрждржорж╛ржи ржлрж╛ржЗрж▓рзЗрж░ ржкрзБрж░рзЛ path (ржлрж╛ржЗрж▓ ржирж╛ржо рж╕рж╣) ржжрзЗржЦрж╛ржмрзЗ

    var_dump($filePath);
    ЁЯФ╣ file_put_contents() ржХрзА?

PHP-ржПрж░ ржПржХржЯрж┐ ржмрж┐рж▓рзНржЯ-ржЗржи ржлрж╛ржВрж╢ржи ржпрж╛ ржХрзЛржирзЛ ржлрж╛ржЗрж▓рзЗрж░ ржнрзЗрждрж░ ржбрзЗржЯрж╛ рж▓рж┐ржЦрждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред
ржПржЯрж╛ ржПржХ рж▓рж╛ржЗржирзЗ ржлрж╛ржЗрж▓ ржУржкрзЗржи + ржбрзЗржЯрж╛ рж▓рж┐ржЦрзЗ + ржлрж╛ржЗрж▓ ржмржирзНржз ржХрж░рзЗ ржжрзЗрзЯред

ЁЯСЙ ржорж╛ржирзЗ fopen(), fwrite(), fclose() тАФ ржПржЗ рждрж┐ржиржЯрж╛рж░ shortcut рж╣рж▓рзЛ file_put_contents()ред

-- file_exists() ржХрзА? PHP-рж░ ржПржХржЯрж╛ built-in function, ржпрзЗржЯрж╛ ржжрж┐рзЯрзЗ ржЪрзЗржХ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржлрж╛ржЗрж▓ (ржмрж╛ ржбрж┐рж░рзЗржХрзНржЯрж░рж┐) ржЖржЫрзЗ ржХрж┐ржирж╛ред
ржПржЯрж╛ true ржмрж╛ false рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗред

ЁЯФ╣ json_encode() ржХрзА?

PHP-рждрзЗ json_encode() рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж╛ ржлрж╛ржВрж╢ржи ржпрзЗржЯрж╛ PHP ржПрж░ array / object ржХрзЗ JSON string ржП рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рзЗред
    -- PHP-рждрзЗ json_decode() рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи ржпрж╛ JSON string ржХрзЗ PHP array ржмрж╛ object ржП рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рзЗред
    -- true ржжрж┐рж▓рзЗ associative array, false ржжрж┐рж▓рзЗ object

    -- json_decode() ржлрж╛ржВрж╢ржи JSON string ржХрзЗ PHP variable (array ржмрж╛ object) ржП рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рзЗред

*/

trait FileHandler {
    private $filePath = __DIR__ . "/../../data/vehicles.json";

    public function readFile() {
        if(!file_exists($this->filePath)){
            file_put_contents($this->filePath, json_encode([]));
        }
        return json_decode(file_get_contents($this->filePath), true);
    }

    public function writeFile($data) {
        file_put_contents($this->filePath, json_encode($data, JSON_PRETTY_PRINT));
    }
}


/*
private $filePath тЖТ ржПржХржЯрж┐ class property, ржпрж╛ рж╢рзБржзрзБ рж╕рзЗржЗ ржХрзНрж▓рж╛рж╕рзЗрж░ ржнрзЗрждрж░ ржерзЗржХрзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж╛ ржпрж╛ржмрзЗред

__DIR__ тЖТ ржПржХржЯрж┐ magic constant; ржПржЯрж┐ ржмрж░рзНрждржорж╛ржи PHP ржлрж╛ржЗрж▓ ржпрзЗржЦрж╛ржирзЗ ржЖржЫрзЗ рж╕рзЗржЗ ржлрзЛрж▓рзНржбрж╛рж░рзЗрж░ absolute path рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗред

/var/www/project/app/controllers

"/../../data/vehicles.json" тЖТ ржорж╛ржирзЗ рж╣рж▓рзЛ ржмрж░рзНрждржорж╛ржи ржлрж╛ржЗрж▓ ржерзЗржХрзЗ рзиржЯрж╛ ржлрзЛрж▓рзНржбрж╛рж░ ржЙржкрж░рзЗ ржЧрж┐рзЯрзЗ data ржлрзЛрж▓рзНржбрж╛рж░рзЗрж░ ржоржзрзНржпрзЗ ржерж╛ржХрж╛ vehicles.json ржлрж╛ржЗрж▓ред
ЁЯСЙ ржХрж╛ржЬ: ржПржЗ рж▓рж╛ржЗржиржЯрж┐ $filePath ржкрзНрж░рзЛржкрж╛рж░рзНржЯрж┐рждрзЗ vehicles.json ржлрж╛ржЗрж▓рзЗрж░ path рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗ, ржпрж╛рждрзЗ ржкрж░рзЗ ржбрзЗржЯрж╛ ржкрзЬрж╛/рж▓рзЗржЦрж╛ ржХрж░рж╛ ржпрж╛рзЯред


ЁЯФ╣ ржХржЦржи Trait ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи?

Trait рж╕рж╛ржзрж╛рж░ржгржд рждржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи:

Multiple classesтАУржП ржПржХржЗ ржзрж░ржирзЗрж░ function ржжрж░ржХрж╛рж░ рж╣рзЯ

ржзрж░рзБржи, User, Admin, Customer тАУ ржПржЗ рждрж┐ржиржЯрж╛ classтАУржП ржПржХржЗ logActivity() ржмрж╛ sendEmail() method ржжрж░ржХрж╛рж░ред

Inheritance ржХрж░рж▓рзЗ ржПржХржЯрж╛ржЗ parent class ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ, ржХрж┐ржирзНрждрзБ ржПржХрж╛ржзрж┐ржХ ржЬрж╛рзЯржЧрж╛рзЯ ржПржХржЗ code reuse ржХрж░рждрзЗ ржЪрж╛ржЗрж▓рзЗ Trait ржнрж╛рж▓рзЛ рж╕ржорж╛ржзрж╛ржиред

Code DRY (Don't Repeat Yourself) рж░рж╛ржЦрждрзЗ ржЪрж╛ржЗрж▓рзЗ

ржмрж╛рж░ржмрж╛рж░ ржПржХржЗ function рж▓рж┐ржЦрждрзЗ ржирж╛ рж╣рзЯрзЗ traitтАУржП ржПржХржмрж╛рж░ рж▓рж┐ржЦрзЗ рж░рзЗржЦрзЗ ржпрзЗржХрзЛржирзЛ classтАУржП reuse ржХрж░рж╛ ржпрж╛рзЯред

Multiple inheritance-ржПрж░ рж╕рзАржорж╛ржмржжрзНржзрждрж╛ ржХрж╛ржЯрж╛рждрзЗ

PHP рждрзЗ ржПржХ class рж╢рзБржзрзБ ржПржХржЯрж┐ржЗ parent class extend ржХрж░рждрзЗ ржкрж╛рж░рзЗред

ржХрж┐ржирзНрждрзБ Trait use ржХрж░рж▓рзЗ ржЖржкржирж┐ ржПржХрж╛ржзрж┐ржХ Trait ржПржХ classтАУржП ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред
*/